<%- macro gen_namespace_name(module, mod_ver) -%>
<= module.name =>_<= mod_ver.major =>_<= mod_ver.minor =>
<%- endmacro %>

<% macro type(obj) -%>
<= obj.cpp =><% if obj.subs[0] is defined %><<% for st in obj.subs %><= type(st) =><= ", " if not loop.last =><% endfor %>><% endif %>
<%- endmacro %>

<%- macro function_header(obj) -%>
<= decl_meta_params(obj) -=>
<= decl_depricated(obj) -=>
<= "static " if obj.static =><=- type(obj.return) => <= obj.name =>(<= fparam(obj.params) =>)<= " const" if obj.mutable == False =>
<%- endmacro %>

<%- macro fparam(params) -%>
<% for param in params %><= type(param.param_t) => <= param.name =><= ", " if not loop.last =><% endfor %>
<%- endmacro %>

<%- macro decl_depricated(obj) -%>
<%- if obj.meta and obj.meta.depricated %>[[depricated<% if obj.meta.depricated.msg != '' %>("<= obj.meta.depricated.msg =>")<% endif %>]] <% endif %>
<%- endmacro %>

<%- macro decl_meta_params(obj) -%>
<%- if obj.meta and obj.meta.doc -%>///  <= obj.meta.doc -=>
<% endif -%>
<%- endmacro %>

<%- macro includes_for(list) -%>
<% for info in list %>
#include <= '<' if info.sys else '"' =><= info.file =><= '>' if info.sys else '"' =>
<%- endfor -%>
<%- endmacro %>

<%- macro includes(incs) -%>
<% for (from, list) in incs.required.items() if from == "cpp" %>
<= includes_for(list) =>
<%- endfor %>
<% for fn in incs.matched%>#include "<= fn =>"
<% endfor -%>
<%- endmacro -%>

<%- macro ptr(obj, cdata) -%><=obj.name=>_ptr<% endmacro -%>


<%- macro interface(obj) -%>
class <= decl_depricated(obj) =><= obj.name => {
public:
	virtual ~<= obj.name =>() noexcept =default;
	<% for fnc in obj.members %>
	virtual <= function_header(fnc) => =0 ;
	<% endfor %>
};
<% endmacro -%>

<%- macro constructor_name(cns, obj, cdata) -%><= cdata.ctor_prefix =><= obj.name =><% endmacro -%>

<% macro enum(obj, module, cdata) -%>
<% set nn = gen_namespace_name(module, cdata) %>
std::string <= nn =>::to_string(<=nn=>::<=obj.name=> v)
{
	<%- for i in  obj.members %>
	if(v==<=obj.name=>::<=i.name=>) return "<=i.output=>";
	<%-endfor%>
	assert(false);
	return "";
}
std::wstring <= nn =>::to_wstring(<=nn=>::<=obj.name=> v)
{
	<%- for i in  obj.members %>
	if(v==<=obj.name=>::<=i.name=>) return L"<=i.output=>";
	<%-endfor%>
	assert(false);
	return L"<=obj.output=>";
}
<% endmacro -%>
